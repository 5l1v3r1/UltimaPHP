## UltimaPHP - Ultima Online OpenSource Server

UltimaPHP is a modern Ultima Online server written in PHP 5.4.

This server was created for thoes who ever wanted to create differend addaptations on the core of your shard or even in Ultima Online.

The base idea of how to keep the server written in PHP alive and monitoring the sockets came from Matthew [Ankron, on sphere community].

I decided to help the project and for study propose i've re-scripted the entire socket server to understand how it works and after that i decided to create a lightweight standalone version of the server that runs in any OS easly.

## How to install?

First of all you will need to install PHP 5.4 or greater and MySQL Server 5 or greater (or any database compatible with PDO) on your machine, for that open this links:

* [PHP download page](http://php.net/downloads.php) and get the version of PHP you want to use
* [MySQL dowload page](http://dev.mysql.com/downloads/mysql/) and get the right version of MySQL for your machine.

After install PHP and MySQL on the machine (mysql will ask to create the password or a new user on the instalation), edit the file ```ultimaphp.ini``` as you wish, import the file ```database.sql``` to your database (with some query program, like [MySQL Workbench](https://dev.mysql.com/downloads/workbench/)) and follow the next steps to start the server:

### Linux

 * Open the terminal and navigate to the root folder of UltimaPHP
 * Type: ```php startserver.php```

### Mac

 * We need someone with mac to help us

### Windows

 * Open the manu bar and open ```cmd```
 * Navigate to PHP installation folder
 * type ```php.exe c:\ultimaphp\instalation\folder\startserver.php```

### What is allready working?

 * Package compression using the Huffman algorythin and the pre-defined Ultima Online Byte Tree
 * Package decompression using the Huffman algorythin and auto-generated Byte Trees
 * Response PING request
 * Disconnect player
 * Login request
 * Login validation trought PDO Database
 * Server list response
 * Get client version information
 * Client selected server handler
 * Character list trought PDO Database (for old and new clients, packet change since client 7.0.13.0)
 * Client selected character handler
 * Enable locked client features
 * Receive the client language (We will use later to create an multi-language shard system)
 * Receive the client Screen Size (I really dunno why... but the client sends anyway before connect to the server)
 * Receive the client flags (I dunno what this is too... but the client sends anyway before connect to the server)
 * Send the player locale and body information to the client
 * Send all skill status to the client (80%, the packet is allready done but we need to create the database to store the skills and show the information on the packet to the client)
 * Connecting the client to the world (80%, we need to script a few packets to make it works)
 * Support for Encrypted clients (0%, we founded information about encrypt/decrypt the packets using the BLOWFISH/TWOFISH algorythin so it's an feature improvement)

 #### Usefull links that could help you code
 
 * [SocketSniff](http://nirsoft.net/utils/socket_sniffer.html) program i use to monitor an program sockets communication
 * [POL Packet Guide](http://docs.polserver.com/packets/index.php) for learning all about the packages sent trought server and client
 * [Sphere 0.56b leaked code](https:///github.com/necr0potenc3/Sphere) to see how things works
 * [RunUO repository](https://github.com/runuo/runuo) to see how things works
 * [POL Repository](https://github.com/polserver/polserver) to see how things works
 * [NodeUO](https://github.com/chjj/node-uo)